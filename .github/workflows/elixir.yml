name: Elixir CI

on: push

jobs:
  test:

    strategy:
      matrix:
        os:
        - macos-latest
        - windows-latest
        - ubuntu-latest

        otp:
        - 21.3
        - 22.1

        elixir:
        - 1.8.2
        - 1.9.4

    runs-on: ${{ matrix.os }}

    services:
      redis:
        image: redis
        ports:
        - 6379:6379

    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-elixir@v1.0.0
      with:
        otp-version: ${{ matrix.otp }}
        elixir-version: ${{ matrix.elixir }}

    - name: Install Dependencies
      run: mix deps.get

    - name: Run Tests
      run: mix test
